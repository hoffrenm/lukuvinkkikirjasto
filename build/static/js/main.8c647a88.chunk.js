(this["webpackJsonplukuvinkkikirjasto-front"]=this["webpackJsonplukuvinkkikirjasto-front"]||[]).push([[0],{38:function(t,e,n){t.exports=n(67)},66:function(t,e,n){},67:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),c=n(15),i=n.n(c),u=n(19),s=n(9),l=n(10),o=n(2),p=n.n(o),m=n(7),f=n(11),d=n(17),v=n.n(d),b={getAll:function(){var t=Object(m.a)(p.a.mark((function t(){var e;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.get("/api/tips");case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),create:function(){var t=Object(m.a)(p.a.mark((function t(e){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.post("/api/tips",e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),remove:function(){var t=Object(m.a)(p.a.mark((function t(e){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.delete("".concat("/api/tips","/").concat(e));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},E=function(t){return Object(f.a)({},t,{createdAt:new Date(t.createdAt)})},k={tipdata:[],processing:!0,error:null},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"INIT_TIPS":case"ADD_TIP":return Object(f.a)({},t,{processing:!0});case"ACTION_SUCCESS":return Object(f.a)({},t,{tipdata:t.tipdata.concat(e.data),processing:!1,error:null});case"ACTION_FAIL":return window.alert("Toiminto ep\xe4onnistui (".concat(e.data,")")),Object(f.a)({},t,{error:e.data,processing:!1});case"REMOVE_TIP":return Object(f.a)({},t,{processing:!0});case"REMOVE_SUCCESS":return Object(f.a)({},t,{tipdata:t.tipdata.filter((function(t){return t.id!==e.data})),processing:!1,error:null});default:return t}},O=n(36),h=function(t){var e=Object(a.useState)(""),n=Object(O.a)(e,2),r=n[0],c=n[1];return{type:t,value:r,onChange:function(t){c(t.target.value)},reset:function(){c("")}}},g=n(37),_=function(t){var e=t.label,n=t.inputValue;return r.a.createElement("div",{className:"form__field form__field--text"},r.a.createElement("label",null,e),r.a.createElement("input",Object.assign({"data-cy":"tip-url",id:"tip_url"},function(t){t.reset;return Object(g.a)(t,["reset"])}(n))))},j=function(t){var e=t.buttonText,n=t.priority,a=t.type,c=t.cyDataAttribute,i=t.onClick;return r.a.createElement("div",{className:"button__container"},r.a.createElement("button",{className:"button button-".concat(n," button-").concat(a),"data-cy":c,type:a,onClick:i},e))},T=Object(s.b)((function(){return{}}),{addTip:function(t,e){return function(){var n=Object(m.a)(p.a.mark((function n(a){var r,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),a({type:"ADD_TIP"}),n.next=4,b.create(e);case 4:201===(r=n.sent).status?(c=E(r.data),a({type:"ACTION_SUCCESS",data:c})):a({type:"ACTION_FAIL",data:r});case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()}})((function(t){var e=h("text"),n=h("text"),a=h("text");return r.a.createElement("div",{className:"form form--add-tip"},r.a.createElement("h3",null,"Lis\xe4\xe4 vinkki"),r.a.createElement("form",{onSubmit:function(r){r.preventDefault(),t.addTip(r,{title:e.value,url:n.value,tags:a.value.split(",").map((function(t){return t.trim()})).filter((function(t){return t.length>0}))}),e.reset(),n.reset(),a.reset()}},r.a.createElement(_,{label:"Otsikko",inputValue:e}),r.a.createElement(_,{label:"Linkki",inputValue:n}),r.a.createElement(_,{label:"Tagit",inputValue:a}),r.a.createElement(j,{buttonText:"Lis\xe4\xe4",priority:"primary",type:"submit",cyDataAttribute:"add-tip"})))})),A=function(){return r.a.createElement("div",null,"Lataillaan...")},I=function(){return r.a.createElement("div",null,r.a.createElement("p",null,"Et ole lis\xe4nnyt vinkkej\xe4 viel\xe4"))},w=Object(s.b)((function(t){return{tips:t.tips}}),{removeTip:function(t){return function(){var e=Object(m.a)(p.a.mark((function e(n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n({type:"REMOVE_TIP"}),e.prev=1,e.next=4,b.remove(t);case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a=e.t0;case 10:204===a.status?n({type:"REMOVE_SUCCESS",data:t}):n({type:"ACTION_FAIL",data:a});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}})((function(t){var e=t.tips,n=e.processing,a=e.tipdata;if(n&&0===a.length)return r.a.createElement(A,null);if(0===a.length)return r.a.createElement(I,null);console.log("TipList: tipdata",a);var c=function(){var e=Object(m.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Poistetaanko lukuvinkki '".concat(n.title,"'?"))&&t.removeTip(n.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h2",null,"Lukuvinkit"),a.sort((function(t,e){return e.createdAt-t.createdAt})).map((function(t){return r.a.createElement("div",{"data-cy":"tip-item",key:t.id,className:"tip-list-item"},r.a.createElement("div",{className:"tip-content"},r.a.createElement("div",{className:"timestamp"},t.createdAt.toLocaleString("fi-FI")),r.a.createElement("h3",null,t.title),r.a.createElement("a",{href:t.url},t.url),r.a.createElement("div",{className:"tip-item__meta tip-item__meta--tags"},t.tags.map((function(e,n){return r.a.createElement("span",{key:"".concat(n,"-").concat(e,"-").concat(t.id),className:"tag_item"},r.a.createElement("span",null,e),n!==t.tags.length-1&&r.a.createElement("span",{className:"sep"},","))}))),r.a.createElement(j,{onClick:function(){return c(t)},buttonText:"Poista",priority:"secondary",type:"button",cyDataAttribute:"remove-tip"})))})))})),x=Object(s.b)((function(t){return{tips:t.tips}}),{initTips:function(){return function(){var t=Object(m.a)(p.a.mark((function t(e){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e({type:"INIT_TIPS"}),t.next=3,b.getAll();case 3:200===(n=t.sent).status?(a=n.data.map(E),e({type:"ACTION_SUCCESS",data:a})):e({type:"ACTION_FAIL",data:n});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(t){return Object(a.useEffect)((function(){t.tips.processing&&t.initTips()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement("h1",{className:"heading heading__h1"},"Lukuvinkkikirjasto"),r.a.createElement("div",{className:"content-container"},r.a.createElement(l.a,{path:"/",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,null),r.a.createElement(w,null))}})))})),N=n(13),C=n(35),S=Object(N.c)({tips:y}),L=Object(N.d)(S,Object(N.a)(C.a));L.subscribe((function(){return console.log(L.getState())}));var D=L,P=(n(66),function(){i.a.render(r.a.createElement(s.a,{store:D},r.a.createElement(u.a,null,r.a.createElement(x,null))),document.getElementById("app"))});P(),D.subscribe(P)}},[[38,1,2]]]);
//# sourceMappingURL=main.8c647a88.chunk.js.map